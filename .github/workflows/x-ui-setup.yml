name: X-UI Panel Setup

on:
  push:
    branches:
      - main

jobs:
  setup:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Install Dependencies
      run: |
        sudo apt update
        sudo apt install -y curl wget sudo

    - name: Download X-UI Script
      run: |
        wget https://github.com/NidukaAkalanka/x-ui-english/raw/main/x-ui.sh
        chmod +x x-ui.sh

    - name: Run X-UI Script
      run: |
        sudo ./x-ui.sh install

    - name: Fetch Public IP Address
      id: get_ip
      run: |
        echo "::set-output name=public_ip::$(curl -s ifconfig.me)"

    - name: Display X-UI Panel URL
      run: |
        echo "X-UI Panel is accessible at http://$(steps.get_ip.outputs.public_ip):54321"
